!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash.merge")):"function"==typeof define&&define.amd?define(["exports","lodash.merge"],t):t(e.VuexPersistence={},e._.merge)}(this,function(e,r){"use strict";r=r&&r.hasOwnProperty("default")?r.default:r;var i=function(){function e(){this._queue=[],this._flushing=!1}return e.prototype.enqueue=function(e){return this._queue.push(e),this._flushing?Promise.resolve():this.flushQueue()},e.prototype.flushQueue=function(){var t=this;this._flushing=!0;var r=function(){var e=t._queue.shift();if(e)return e.then(r);t._flushing=!1};return Promise.resolve(r())},e}();function n(e,t){return r({},e,t)}var u=JSON,t=function(e){var s=this;this._mutex=new i,this.subscriber=function(t){return function(e){return t.subscribe(e)}},void 0===e&&(e={}),this.key=null!=e.key?e.key:"vuex",this.subscribed=!1,this.supportCircular=e.supportCircular||!1,this.supportCircular&&(u=require("circular-json")),this.storage=e.storage||window.localStorage,this.reducer=null!=e.reducer?e.reducer:null==e.modules?function(e){return e}:function(s){return e.modules.reduce(function(e,t){var r;return n(e,((r={})[t]=s[t],r))},{})},this.filter=e.filter||function(e){return!0},this.strictMode=e.strictMode||!1,this.RESTORE_MUTATION=function(e,t){for(var r=n(e,t||{}),s=0,i=Object.keys(r);s<i.length;s++){var u=i[s];this._vm.$set(e,u,r[u])}},this.asyncStorage=e.asyncStorage||!1;var t=this.storage&&this.storage._config;this.asyncStorage=this.asyncStorage||"localforage"===(t&&t.name),this.asyncStorage?(this.restoreState=null!=e.restoreState?e.restoreState:function(e,t){return t.getItem(e).then(function(e){return"string"==typeof e?s.supportCircular?u.parse(e||"{}"):JSON.parse(e||"{}"):e||{}})},this.saveState=null!=e.saveState?e.saveState:function(e,t,r){return r.setItem(e,"localforage"===(r&&r._config&&r._config.name)?n({},t||{}):s.supportCircular?u.stringify(t):JSON.stringify(t))},this.plugin=function(t){s.restoreState(s.key,s.storage).then(function(e){s.strictMode?t.commit("RESTORE_MUTATION",e):t.replaceState(n(t.state,e||{})),t._vm.$root.$emit("vuexPersistStateRestored"),t._vm.$root.$data.vuexPersistStateRestored=!0,s.subscriber(t)(function(e,t){s.filter(e)&&s._mutex.enqueue(s.saveState(s.key,s.reducer(t),s.storage))}),s.subscribed=!0})}):(this.restoreState=null!=e.restoreState?e.restoreState:function(e,t){var r=t.getItem(e);return"string"==typeof r?s.supportCircular?u.parse(r||"{}"):JSON.parse(r||"{}"):r||{}},this.saveState=null!=e.saveState?e.saveState:function(e,t,r){return r.setItem(e,s.supportCircular?u.stringify(t):JSON.stringify(t))},this.plugin=function(e){var t=s.restoreState(s.key,s.storage);s.strictMode?e.commit("RESTORE_MUTATION",t):e.replaceState(n(e.state,t||{})),s.subscriber(e)(function(e,t){s.filter(e)&&s.saveState(s.key,s.reducer(t),s.storage)}),s.subscribed=!0})};e.VuexPersistence=t,e.default=t,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.min.js.map
